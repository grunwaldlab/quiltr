---
title: "Making a website from HTML files"
author: "Zachary Foster"
output:
  rmarkdown::html_vignette:
    toc: true
    css: custom.css
  self_contained: false
vignette: >
  %\VignetteIndexEntry{Making a website from HTML files}
  %\VignetteEngine{knitr::rmarkdown}
  %\usepackage[utf8]{inputenc}
---

## Introduction

The primary purpose of this package is to provide a way to combine `.html` files scattered throughout a file system into a single website with a hierarchical dropdown menu.
The package was designed to facilitate embedding notes into computational science projects and making research notebooks.
For this reason, quiltr is most appropriate for creating websites to document projects, where ease of use, transparency, and reliability are the priority.
Making simple static websites for other purposes is also possible, but quiltr is not designed be an all-purpose website generator such as Jykell or Drupal.
All of the content of the webpage besides the dropdown menu and other basic site structure elements is in the form of HTML files created by the user.
HTML files can be made using a variety of software and any HTML file should work.
Rmarkdown is particularly suited to be used with quiltr; together the two can be used to create online lab notebooks without any knowledge of web design or HTML, for free, on any operating system.


## How it works

The locations html file content is displayed on the website and the hierarchy of the menu itself are determined by the names of the files/directories in html files' path or customized using configuration files in the same directories.
The benefit of this system is that there are very few restrictions on the layout of the file structure and no knowledge of web design needed beyond the ability to create HTML content (e.g. using Rmd or Word).
This allows for HTML notes embedded in an analysis directory to provide integrated documentation.
It is so flexible that website can be made for any directory containing `.html` files, regardless if the html files or the directory were made for this purpose.

A single function called `make_website` is given a target directory containing `.html` files and a location to output a website directory. 
In the website output directory, a copy of the target directory is made with only the `.html` files and any local files (e.g. images) they reference (via HTML tag attributes like `src` and `href`). 
A `.html` file for each page of the website (i.e. each location in the menu) is then generated to display the content of input `.html` files assigned to that location.
Together, the partial copy of the target directory and the page `.html` files constitute a portable website that can be uploaded to a web server.
If the contents of the target directory change the function can be run again to update the website.


### Inferring menu hierarchy 

The most useful feature of quiltr is inferring a menu hierarchy from the context of HTML files.
There are two general ways to go about doing this: using file path/name elements and using configuration files to specify custom locations.
Using file path information is probably most appropriate for documenting a computational analysis or research notebook directory since it takes the least upkeep effort and the organization of the project itself is evident in the website.
Using configuration files can be more involved, but allows for a completely customized hierarchy regardless of the directory or name of HTML content files making it more appropriate for more conventional websites.
In both cases, the menu can have infinite levels and is mobile-friendly.


#### Using file path information

The placement of HTML content can be determined by the names of directories in its path relative to some "root" directory.
The depth 
For example, if you had the following 3 HTML files on your computer...

```
/home/your_name/documents/notes/old/note_1.html
/home/your_name/documents/notes/old/note_2.html
/home/your_name/documents/notes/old/sub_dir/note_3.html
/home/your_name/documents/notes/old/sub_dir/another_sub_dir/note_4.html
/home/your_name/documents/notes/new/note_5.html
```

...and you specified that the "root" of the target directory is `/home/your_name/documents/notes`, then: 

* note 1 and 2 would appear together on a page of the website reached by the `old` menu item
* note 3 would appear on a page accessed by a sub-menu (`old` > `sub_dir`)
* note 4 would appear on a page accessed by a sub-menu (`old` > `sub_dir` > `another_sub_dir`)
* note 5 would appear on a page accessed by the menu item `new`

Which parts of the file path are used and how they are processed is affected by a variety of options. 
The example showed above corresponds to the default options values, but many variations are possible.
Below is an example of its output...

```{r make_test_website_1, echo=FALSE, results='hide', eval=FALSE}
# This is not run automatically due to rmarkdown issue #248, but is used to make the website example
quiltr::make_website(path = "vignette_examples/test_website_1", output = "inst/doc", overwrite = TRUE, output_dir_name = "test_website_1", theme = "cerulean")
```

<style>
    #wrap { width: 700px; height: 350px; padding: 0; overflow: hidden; }
    #frame { width: 1100px; height: 550px; }
    #frame {
        -ms-zoom: 0.6363636;
        -moz-transform: scale(0.6363636);
        -moz-transform-origin: 0 0;
        -o-transform: scale(0.6363636);
        -o-transform-origin: 0 0;
        -webkit-transform: scale(0.6363636);
        -webkit-transform-origin: 0 0;
    }
</style>

<div id="wrap"><iframe id="frame" src="test_website_1/index.html"></iframe></div>


#### Using content placement configurartion files

Configuration files can be used to specify the location in the menu hierarchy of specific HTML files.
This can be used in combination with or interdependent of the file path information when determining display location.
For example, below is the same as the previous one except for the addition of two configuration files named `.note_config`:

```
/home/your_name/documents/notes/old/note_1.html
/home/your_name/documents/notes/old/note_2.html
/home/your_name/documents/notes/old/note_config.yml
/home/your_name/documents/notes/old/sub_dir/note_3.html
/home/your_name/documents/notes/old/sub_dir/note_config.yml
/home/your_name/documents/notes/old/sub_dir/another_sub_dir/note_4.html
/home/your_name/documents/notes/new/note_5.html
```

The name of the configuration files can be specified when building the website, so they can be named anything as long as it is consistent for a given notebook; in this instance they are named `note_config.yml`.
The content of the configuration files should be a named list in YAML format, where the name is a file path relative to the configuration files' location and the elements of the list are website menu locations.
The file path can include wildcards or other common file path syntax. 
The configuration files listed above in the example have the following content: 

`/home/your_name/documents/notes/old/note_config.yml`:

```{r, echo=FALSE, comment=""}
cat(readChar("../vignette_examples/test_website_2/old/note_config.yml", nchars = 10000))
```

`/home/your_name/documents/notes/old/sub_dir/note_config.yml`:

```{r, echo=FALSE, comment=""}
cat(readChar("../vignette_examples/test_website_2/old/sub_dir/note_config.yml", nchars = 10000))
```

The first configuration file causes the content of `note_1.html` to be displayed in the menu location `custom` > `placement` instead of `old`. 
The second has two effects:

* The the levels `relative` > `placement` are added to the menu location of `note_3.html` is displayed under. They are added to the menu path instead of replacing it due to the `.` as the first list element, so the location in the hierarchy is `old` > `sub_dir` > `relative` > `placement`.
* All HTML files in any sub directory (relative to `/home/your_name/documents/notes/old/sub_dir`) will not be included in the website due to `NULL` being the only element specified. In this case, `note_4.html` will not be included. 

Below is the result of building the above directory structure using default options:

```{r make_test_website_2, echo=FALSE, results='hide', eval=FALSE}
# This is not run automatically due to rmarkdown issue #248, but is used to make the website example
quiltr::make_website(path = "vignette_examples/test_website_2", output = "inst/doc", overwrite = TRUE, output_dir_name = "test_website_2", note_config_name = "note_config.yml", theme = "cerulean")
```


<div id="wrap"><iframe id="frame" src="test_website_2/index.html"></iframe></div>


### How content is combined on each page

Each page on the website is essentially a menu linking all the other pages and a series of iframes used to display HTML files assigned to that page.
The iframes are automatically scaled to fit their content so they are seamlessly integrated into the website.
One benefit of this system is that even if a note appears multiple places on the website, it is only stored once.
Also, the original file is available for viewing or download (in Firefox: `right click` > `This frame` > ...), which is useful for printing notes or viewing embedded HTML slide shows.

### Using a website build configuration file

In addition to the configuration files used to determine content location, there is another type of configuration file used to specify default website building options. 
This configuration file is in YAML format and contains the values of some or all of the options accepted by the `make_website` function.
Option values specified replace the defaults when running `make_website` on the directory containing the configuration file, although options specified in the configuration file can still be overwritten by function options used. 
There is one of this type of the configuration file per website. 
They can be used to store the options used to build a specific website in the source of the website itself.
The configuration file used can be specified by a `make_website` option, so that an existing website can be rebuilt without having to remember the options used.
Below is an example of website build configuration file content:

```
clean: false
theme: cosmo
note_config_name: note_config.yml
```

In the context of the previous examples, this configuration file would be saved at `/home/your_name/documents/notes/build_config.yml`.
See the following section for potential `make_website` options used when building the website.


## Aruments and options

So far, the examples have used mostly the default option values for `make_website`, but there are many more options that can significantly alter the output and functionality. 

### Main arguments

#### Target directory (`path`):

This is the directory in which to search HTML content files.
It is also the root directory used to inferr the website menu hierarcy when `use_dir_names = TRUE`.
The default is the current working directory.

#### Output directory (`output`):

The path to where an output directory will be made with a name speficied by `output_dir_name`.
The default is the value of the `path` argument.

### Website menu hierarchy options

#### Displaying content on every page in its menu hierarchy (`cumulative`):

Currently, intermediate levels in the menu hierarchy cannot be selected, but there are plans to make them clickable.
Once that happens, this option will become more relevant. 

If `TRUE`, each peice of HTML content are displayed on every level of its menu classification. 
For examle, if `note_1.html` is assigned to `a` > `b` > `c` and `note_2.html` is assigned to `a` > `b`, then the `a` page and `a` > `b` page will display both notes. 
The default is `TRUE`.

#### Using file names (`use_file_names`):

If `TRUE`, the names of HTML content files will be used when infering the menu hierarchy.
In other words, the name of the HTML file (minus the `.html`) will be in the website menu.
The file name can be split using the `name_sep` option into multiple levels in the menu. 
See the `name_sep` documentation for more details. 
The default is `FALSE`

#### Using directory path names (`use_dir_names`):

If `TRUE`, the directory path of HTML content files relative to the target directory (`path`) will be used when infering the menu hierarchy.
In other words, directory names in the target directory will be in the website menu.
The  directory names can be split using the `name_sep` option into multiple levels in the menu. 
See the `name_sep` documentation for more details. 
The default is `TRUE`

#### Splitting file path names by spearator (`name_sep`):

A character to split directory and file names by before using the information to infer the menu hierarchy.
This allows for multiple levels in a hierarchy to be defined in the same directory. 
This option only has an effect if `use_file_names = TRUE` or `use_dir_names = TRUE`.
Set to `NULL` to not split names.
The defualt is `-`. 

#### Including last part of file name in hierarchy (`use_file_suffix`):

When a file name is split using `name_sep`, include the last peice in the menu hierarchy.
Only has an effect if `use_file_names = TRUE` and `name_sep != NULL`.
The default is `FALSE`.

#### Including last part of directory path in hierarchy (`use_dir_suffix`):

When a directory name is split using `name_sep`, include the last peice in the menu hierarchy.
Only has an effect if `use_file_names = TRUE` and `name_sep != NULL`.
The default is `TRUE`.

#### Using configuration for custom placement (`use_config_files`):

Use configuration files that specify the location of HTML file content in the menu hierarchy. 
These files must be named as specified by option `note_config_name` and occure anywhere in the target directory.
The default is `TRUE`.

#### Specify name of custom placement configuration files (`note_config_name`):

The name of configuration files anywhere in the target directory that specify the location of HTML file content in the menu hierarchy. 
The default is `.note.yml`.

#### Specify name of website configuration file (`site_config_name`):

The name of the configuration file used to provide defualt option values for this function. 
If one exists, it should be in the root of the target directory.
The default is `.website_config.yml`.


#### Specify a website configuration file (`site_config_file`):

The path to a build configuration file containing defualt option values for this function in YAML format.
In can also be the path to a directory where a file exists that is named the same as `site_config_name`.
Below is an example of possible content: 

```
clean: false
theme: cosmo
note_config_name: note_config.yml
```

The defualt is to look for a configuration file named as specified by option `site_config_name` in the target directory (argument `path`).


### Website appearance options

#### Bootstrap theme (`theme`):

The bootstrap theme used in the website.
For current options, see the [Rmarkdown documentation](http://rmarkdown.rstudio.com/html_document_format.html#appearance-and-style).
At the time of writing, the following themes were available:

* default
* cerulean
* journal
* flatly
* readable
* spacelab
* united
* cosmo

The default is `journal`.

#### Applying theme to embedded HTML content (`apply_theme`):

If `TRUE`, apply Bootstrap theme CSS to note content.
This might not work on all browsers yet.
The default is `FALSE`. 

### Output file structure options

#### Specify output directory names (`output_dir_name`):

The name of the output directory made in the locaiton specified by argument `ouput` containing the website.
The default is `website`. 

#### Remove intermediate files (`clean`):

If `TRUE`, intermediate files in the output directory are deleted after use (e.g. the Rmd files used to make website HTML).
This is `TRUE` by default.

#### Overwrite previous output (`overwrite`):

If `TRUE`, an existing directory with the same name as the output directory will be overwritten.
This is `FALSE` by default to avoid accedental deletions.

**WARNING:** it is possible to accedentally delete whole directories when `overwrite = TRUE`. 
For example, consider the result of trying to output in root (`/`) when `output_dir_name = 'home'` and `overwrite = TRUE`.
